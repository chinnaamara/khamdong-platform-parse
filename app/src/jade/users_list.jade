//
   Created by chinna on 5/9/14.

section.container
    .row
        .col-lg-12
            .panel.panel-primary
                .panel-heading Users
                .panel-body
                    .loader-div(ng-show='loading')
                        h4 Loading, Please wait...
                    .main-div(ng-show="loadDone")
                        a.btn.btn-info.pull-left.btn-sm(href="", data-toggle="modal",id='btn-sendSms', data-target="#smsWindow", ng-click="isUser()", ng-disabled='cantSendMessage')
                            i.glyphicon.glyphicon-send
                            |   New Messsage
                        | &nbsp;
                        a.btn.btn-info.btn-sm(ui-sref='sentMessages')
                            i.glyphicon.glyphicon-send
                            |   Sent Messsages
                        | &nbsp;
                        a.btn.btn-info.btn-sm(href="", data-toggle="modal",id='btn-addUser', data-target="#newUserWindow", ng-click="isNewUser()")
                            i.glyphicon.glyphicon-plus
                            |   Add User
                        | &nbsp;
                        select(
                            name='selectCategory',
                            ng-options='cat.id as cat.name for cat in categories',
                            ng-model='selectCategory',
                            ng-change='getCategoryUsers()',
                            required)
                                option(value='',selected) -- Select Category --
                        .search.col-xs-4.pull-right
                            input(type="search", class="form-control", ng-model="searchTerm", placeholder="search user")

                        .table-responsive
                            table#usersTable(class="table table-striped table-bordered table-condensed")
                                thead
                                    tr
                                        th.checkboxes.smallBox
                                            input#allUsersCheck.checkbox-inline(type='checkbox', name='checkAll', ng-model='selectedAll', ng-click='allUsersClicked()', ng-checked='allUsersMet()')
                                        th.smallTd #
                                        th User Name
                                        th Mobile Number
                                        th Category
                                        th Email
                                tbody
                                    tr(ng-repeat='user in userslist | orderByPriority | filter: searchTerm')
                                        td.checkboxes
                                            input.userCheck.checkbox-inline(type='checkbox', ng-model='user.done')
                                        td
                                            button.btn.btn-warning.btn-sm(href="", title='Edit', data-toggle="modal",id='btn-editUser', data-target="#newUserWindow",ng-click='editUser(user)')
                                                i.glyphicon.glyphicon-edit
                                                //|   Edit
                                            a.btn.btn-sm.btn-danger(href="",title="Delete", id='btn-deleteUser', ng-click='deleteUser(user)', ng-confirm-click='Are You Sure?')
                                                i.glyphicon.glyphicon-remove
                                        td
                                            span {{ user.name }}
                                        td
                                            span {{ user.mobileNumber }}
                                        td
                                            span {{ user.category }}
                                            //select#category(
                                            //name='category',
                                            //ng-options='cat.name as cat.name for cat in categories'
                                            //ng-model='user.category',
                                            //readonly)
                                        td
                                            span {{ user.email }}
                            .pull-left
                                button.btn.btn-info.btn-sm#prev(ng-click='pageBack()', ng-disabled='noPrevious')
                                    i.glyphicon.glyphicon-arrow-left
                                    |   Previous
                                button.btn.btn-info.btn-sm#next(ng-click='pageNext()', ng-disabled='noNext')
                                    |   Next
                                    | &nbsp;
                                    i.glyphicon.glyphicon-arrow-right

#smsWindow.modal.fade.bs-example-modal-lg(tabindex='-1', role='dialog', aria-labelledby='myLargeModalLabel', aria-hidden='true')
    .modal-dialog
        .modal-content
            .modal-header.bg-primary
                | Send SMS
                button.close(type='button btn-primary', data-dismiss='modal' data-target='.bs-example-modal-lg')
                    span(aria-hidden='true') ×
                    span.sr-only Close
            .modal-body
                form#messageForm(name='messageForm',class='form-horizonal',type='form',novalidate)
                    .form-group.has-warning
                        label.control-label(for='message')
                            | Message
                            span(class='star-label') *
                        div
                            textarea#message.form-control(name='message',ng-model='messageText', maxlength='160', placeholder='Type message here..', required)
                            small(class="label label-danger",ng-show="messageForm.message.$invalid && messageForm.message.$dirty")
                    //.form-group.has-warning
                    //    .alert.alert-success(ng-show='successMessage')
                    //        i.fa.fa-check-circle-o
                    //            | Message sent success to selected members.!
            .modal-footer
                button.btn.btn-primary.btn-sm(ng-click='sendSms()', ng-disabled='messageForm.$invalid', data-dismiss='modal')
                    i.glyphicon.glyphicon-send
                    |   Send
                //button.btn.btn-warning.btn-sm(data-dismiss='modal', ng-click='reset()')
                //    i.glyphicon.glyphicon-remove
                //    |   Cancel

#newUserWindow.modal.fade.bs-example-modal-lg(tabindex='-1', role='dialog', aria-labelledby='myLargeModalLabel', aria-hidden='true')
    .modal-dialog
        .modal-content
            .modal-header.bg-primary
                | {{ modelTitle }}
                button.close(type='button btn-primary', data-dismiss='modal' data-target='.bs-example-modal-lg')
                    span(aria-hidden='true') ×
                    span.sr-only Close
            .modal-body
                form#newUserForm(name='newUserForm',class='form-horizonal',type='form',novalidate)
                    .form-group.has-warning
                        label.control-label(for='category')
                            | Select Category
                            span(class='star-label') *
                        //select.form-control(
                        //    name='category',
                        //    ng-options='cat.name as cat.name for cat in categories',
                        //    ng-model='category',
                        //    required)
                        //    option(value='',selected) -- Select Category --
                        select.form-control(ng-model='category', required)
                            option(value='',selected) -- Select Category --
                            option(value='{{cat.id}}', ng-repeat='cat in categories') {{ cat.name }}
                    .form-group.has-warning
                        label.control-label(for='newUserName')
                            | User Name
                            span(class='star-label') *
                        div
                            input#newUserName.form-control(type='text',name='newUserName',ng-model='newUserName', placeholder='User Name', required)
                            small(class="label label-danger",ng-show="newUserForm.newUserName.$invalid && newUserForm.newUserName.$dirty")
                    .form-group.has-warning
                        label.control-label(for='mobileNumber')
                            | Mobile Number
                            span(class='star-label') *
                        div
                            input#mobileNumber.form-control(type='tel',name='mobileNumber',ng-model='mobileNumber', placeholder='Mobile Number', ng-maxlength='10', ng-minlength='10', required)
                            small(class="label label-danger",ng-show="newUserForm.mobileNumber.$invalid && newUserForm.mobileNumber.$dirty")
                    .form-group.has-warning
                        label.control-label(for='email')
                            | Email
                        div
                            input#email.form-control(type='email',name='email',ng-model='email', placeholder='Email')
            .modal-footer
                button.btn.btn-success.btn-sm(ng-click="addNewUser()", ng-disabled='newUserForm.$invalid', id='btnAddUser')
                    i.glyphicon.glyphicon-ok
                    |   {{ buttonText }}
                button.btn.btn-warning.btn-sm(data-dismiss='modal')
                    i.glyphicon.glyphicon-remove
                    |   Close

                .alert.alert-success(ng-show='successMessage')
                    i.fa.fa-check-circle-o
                        | {{ statusText }}
